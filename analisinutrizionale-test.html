<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alcolisti Anonymous</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h1 class="text-center">Alcolisti Anonymous</h1>
        
        <div class="row">
            <div class="col-md-6">
                <h2>Seleziona drink</h2>
                <div class="form-group">
                    <select id="drinkSelect" class="form-control">
                        <option value="Birra media bionda" data-tipo="drink" data-gradazione="5%" data-calorie="150" data-costo="5">Birra media bionda - 5€</option>
                        <option value="Birra media rossa" data-tipo="drink" data-gradazione="6%" data-calorie="170" data-costo="5">Birra media rossa - 5€</option>
                        <option value="Birra Moretti da 66" data-tipo="drink" data-gradazione="4.6%" data-calorie="220" data-costo="1.5">Birra Moretti da 66 - 1.5€</option>
                        <option value="Gin Tonic" data-tipo="drink" data-gradazione="10%" data-calorie="200" data-costo="7">Gin Tonic - 7€</option>
                        <option value="Bottiglia di vino" data-tipo="drink" data-gradazione="12%" data-calorie="600" data-costo="14">Bottiglia di vino - 14€</option>
                        <option value="Calice di vino" data-tipo="drink" data-gradazione="12%" data-calorie="120" data-costo="3">Calice di vino - 3€</option>
                        <option value="Spritz Campari" data-tipo="drink" data-gradazione="8%" data-calorie="150" data-costo="3">Spritz Campari - 3€</option>
                        <option value="Crodino" data-tipo="drink" data-gradazione="0%" data-calorie="152.5" data-carbs="37.5" data-sugars="37.5" data-protein="0" data-fat="0" data-costo="2.5">Crodino - 2.5€</option>
                        <option value="Red Bull" data-tipo="drink" data-gradazione="0%" data-calorie="112.5" data-carbs="28" data-sugars="27" data-protein="1" data-fat="0" data-costo="2.5">Red Bull - 2.5€</option>
                        <option value="Corona" data-tipo="drink" data-gradazione="4.6%" data-calorie="140" data-carbs="13.1" data-sugars="0" data-protein="1" data-fat="0" data-costo="3">Corona - 3€</option>
                        <option value="Birra Peroni" data-tipo="drink" data-gradazione="4.7%" data-calorie="257.4" data-carbs="23.4" data-sugars="0" data-protein="2" data-fat="0" data-costo="2.5">Birra Peroni - 2.5€</option>
                    </select>
                </div>
                <button id="addDrinkButton" class="btn btn-primary">Aggiungi Drink</button>
                <button id="clearAllDrinksButton" class="btn btn-danger">Cancella Tutto</button>
            </div>
            <div class="col-md-6">
                <h2>Seleziona cibo</h2>
                <div class="form-group">
                    <select id="foodSelect" class="form-control">
                        <option value="Pizza" data-tipo="food" data-calorie="834" data-carbs="97" data-sugars="6" data-protein="37" data-fat="27" data-saturatedfat="10" data-sodium="1120" data-fiber="6" data-costo="7">Pizza - 7€</option>
                        <option value="Bastoncino Findus" data-tipo="food" data-calorie="210" data-carbs="21" data-sugars="1" data-protein="12" data-fat="9" data-saturatedfat="1" data-sodium="400" data-fiber="1" data-costo="2.5">Bastoncino Findus - 2.5€</option>
                        <option value="Uovo" data-tipo="food" data-calorie="68" data-carbs="1" data-sugars="1" data-protein="6" data-fat="5" data-saturatedfat="1.6" data-sodium="62" data-fiber="0" data-costo="0.5">Uovo - 0.5€</option>
                        <option value="Pasta al pesto" data-tipo="food" data-calorie="360" data-carbs="40" data-sugars="3" data-protein="12" data-fat="18" data-saturatedfat="3" data-sodium="550" data-fiber="2" data-costo="3.5">Pasta al pesto - 3.5€</option>
                        <option value="Tramezzino con Philadelphia" data-tipo="food" data-calorie="250" data-carbs="30" data-sugars="3" data-protein="8" data-fat="10" data-saturatedfat="5" data-sodium="450" data-fiber="2" data-costo="2">Tramezzino con Philadelphia - 2€</option>
                    </select>
                </div>
                <button id="addFoodButton" class="btn btn-primary">Aggiungi Cibo</button>
                <button id="clearAllFoodsButton" class="btn btn-danger">Cancella Tutto</button>
            </div>
        </div>
        
        <div class="row mt-5">
            <div class="col-md-6">
                <h2>Elementi giornalieri - Drink</h2>
                <ul id="dailyDrinks" class="list-group"></ul>
            </div>
            <div class="col-md-6">
                <h2>Elementi giornalieri - Cibo</h2>
                <ul id="dailyFoods" class="list-group"></ul>
            </div>
        </div>
        
        <h2 class="mt-5">Informazioni</h2>
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>Elemento</th>
                    <th>Tipo</th>
                    <th>Calorie</th>
                    <th>Carboidrati</th>
                    <th>Zuccheri</th>
                    <th>Proteine</th>
                    <th>Grassi</th>
                    <th>Quantità</th>
                    <th>Calorie Totali</th>
                    <th>Costo Unitario</th>
                    <th>Costo Totale</th>
                </tr>
            </thead>
            <tbody id="nutritionalInfo">
            </tbody>
        </table>
        
        <h3 id="totalDrinkCalories" class="mt-3">Calorie Totali (Drink): 0</h3>
        <h3 id="totalFoodCalories" class="mt-3">Calorie Totali (Cibo): 0</h3>
        <h3 id="totalCalories" class="mt-3">Calorie Totali: 0</h3>
        <h3 id="totalCost" class="mt-3">Costo Totale: 0€</h3>
        
        <button id="analysisButton" class="btn btn-info mt-3">Analisi Bevande</button>
        <button id="generateChartButton" class="btn btn-success mt-3">Genera Grafico</button>

        <div id="analysisSection" class="mt-5" style="display: none;">
            <h2>PARAGONA</h2>
            <div class="form-group">
                <select id="comparisonSelect" class="form-control">
                    <option value="pizza" data-calorie="800">Pizze Margherita (800 kcal)</option>
                    <option value="macbacon" data-calorie="600">MacBacon (600 kcal)</option>
                    <option value="pasta" data-calorie="350">Pasta al ragù 100g (350 kcal)</option>
                </select>
            </div>
            <button id="compareButton" class="btn btn-secondary">Paragona</button>
            <h3 id="comparisonResult" class="mt-3"></h3>

            <h2 class="mt-5">COSTI</h2>
            <h3 id="weeklyCost">Costo Settimanale: 0€</h3>
            <h3 id="monthlyCost">Costo Mensile: 0€</h3>
            <h3 id="yearlyCost">Costo Annuale: 0€</h3>
        </div>

        <canvas id="chartCanvas" class="mt-3"></canvas>
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        $(document).ready(function() {
            var drinks = {};
            var foods = {};

            const dailyRecommendedValues = {
                calories: 2500,
                carbs: 300,
                sugars: 36,
                protein: 56,
                fat: 70
            };

            $("#addDrinkButton").click(function() {
                var selectedOption = $("#drinkSelect option:selected");
                var drinkName = selectedOption.val();
                var gradazione = selectedOption.data("gradazione");
                var calorie = selectedOption.data("calorie");
                var carbs = selectedOption.data("carbs");
                var sugars = selectedOption.data("sugars");
                var protein = selectedOption.data("protein");
                var fat = selectedOption.data("fat");
                var costo = selectedOption.data("costo");

                if (!drinks[drinkName]) {
                    drinks[drinkName] = {
                        quantity: 0,
                        gradazione: gradazione,
                        calorie: calorie,
                        carbs: carbs,
                        sugars: sugars,
                        protein: protein,
                        fat: fat,
                        costo: costo
                    };
                }

                drinks[drinkName].quantity += 1;
                updateDailyDrinks();
                updateNutritionalInfo();
                updateTotalValues();
            });

            $("#addFoodButton").click(function() {
                var selectedOption = $("#foodSelect option:selected");
                var foodName = selectedOption.val();
                var calorie = selectedOption.data("calorie");
                var carbs = selectedOption.data("carbs");
                var sugars = selectedOption.data("sugars");
                var protein = selectedOption.data("protein");
                var fat = selectedOption.data("fat");
                var saturatedFat = selectedOption.data("saturatedfat");
                var sodium = selectedOption.data("sodium");
                var fiber = selectedOption.data("fiber");
                var costo = selectedOption.data("costo");

                if (!foods[foodName]) {
                    foods[foodName] = {
                        quantity: 0,
                        calorie: calorie,
                        carbs: carbs,
                        sugars: sugars,
                        protein: protein,
                        fat: fat,
                        saturatedFat: saturatedFat,
                        sodium: sodium,
                        fiber: fiber,
                        costo: costo
                    };
                }

                foods[foodName].quantity += 1;
                updateDailyFoods();
                updateNutritionalInfo();
                updateTotalValues();
            });

            $("#clearAllDrinksButton").click(function() {
                drinks = {};
                updateDailyDrinks();
                updateNutritionalInfo();
                updateTotalValues();
            });

            $("#clearAllFoodsButton").click(function() {
                foods = {};
                updateDailyFoods();
                updateNutritionalInfo();
                updateTotalValues();
            });

            $("#analysisButton").click(function() {
                $("#analysisSection").toggle();
            });

            $("#compareButton").click(function() {
                var selectedOption = $("#comparisonSelect option:selected");
                var comparisonCalories = selectedOption.data("calorie");
                var totalDrinkCalories = calculateTotalCalories('drink');
                var comparisonResult = totalDrinkCalories / comparisonCalories;

                $("#comparisonResult").text("Equivalente a: " + comparisonResult.toFixed(2) + " " + selectedOption.text());
            });

            $("#generateChartButton").click(function() {
                var ctx = $("#chartCanvas");
                var labels = ["Calories", "Carbohydrates", "Sugars", "Protein", "Fat"];
                var totalDrinkValues = calculateTotalNutrients('drink');
                var totalFoodValues = calculateTotalNutrients('food');
                var totalValues = {
                    calories: totalDrinkValues.calories + totalFoodValues.calories,
                    carbs: totalDrinkValues.carbs + totalFoodValues.carbs,
                    sugars: totalDrinkValues.sugars + totalFoodValues.sugars,
                    protein: totalDrinkValues.protein + totalFoodValues.protein,
                    fat: totalDrinkValues.fat + totalFoodValues.fat
                };

                new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'Valori nutrizionali assunti - Drink',
                            data: [totalDrinkValues.calories, totalDrinkValues.carbs, totalDrinkValues.sugars, totalDrinkValues.protein, totalDrinkValues.fat],
                            backgroundColor: 'rgba(54, 162, 235, 0.2)',
                            borderColor: 'rgba(54, 162, 235, 1)',
                            borderWidth: 1
                        }, {
                            label: 'Valori nutrizionali assunti - Food',
                            data: [totalFoodValues.calories, totalFoodValues.carbs, totalFoodValues.sugars, totalFoodValues.protein, totalFoodValues.fat],
                            backgroundColor: 'rgba(255, 99, 132, 0.2)',
                            borderColor: 'rgba(255, 99, 132, 1)',
                            borderWidth: 1
                        }, {
                            label: 'Valori nutrizionali giornalieri raccomandati',
                            data: [dailyRecommendedValues.calories, dailyRecommendedValues.carbs, dailyRecommendedValues.sugars, dailyRecommendedValues.protein, dailyRecommendedValues.fat],
                            backgroundColor: 'rgba(75, 192, 192, 0.2)',
                            borderColor: 'rgba(75, 192, 192, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            });

            function updateDailyDrinks() {
                var $dailyDrinks = $("#dailyDrinks");
                $dailyDrinks.empty();

                $.each(drinks, function(name, info) {
                    $dailyDrinks.append('<li class="list-group-item">' + name + ' - Quantità: ' + info.quantity + 
                    ' <button class="btn btn-sm btn-danger ml-2" onclick="decreaseQuantity(\'drink\', \'' + name + '\')">-</button> ' + 
                    ' <button class="btn btn-sm btn-success ml-2" onclick="increaseQuantity(\'drink\', \'' + name + '\')">+</button></li>');
                });
            }

            function updateDailyFoods() {
                var $dailyFoods = $("#dailyFoods");
                $dailyFoods.empty();

                $.each(foods, function(name, info) {
                    $dailyFoods.append('<li class="list-group-item">' + name + ' - Quantità: ' + info.quantity + 
                    ' <button class="btn btn-sm btn-danger ml-2" onclick="decreaseQuantity(\'food\', \'' + name + '\')">-</button> ' + 
                    ' <button class="btn btn-sm btn-success ml-2" onclick="increaseQuantity(\'food\', \'' + name + '\')">+</button></li>');
                });
            }

            window.decreaseQuantity = function(type, name) {
                if (type === 'drink' && drinks[name].quantity > 0) {
                    drinks[name].quantity -= 1;
                    if (drinks[name].quantity === 0) {
                        delete drinks[name];
                    }
                    updateDailyDrinks();
                } else if (type === 'food' && foods[name].quantity > 0) {
                    foods[name].quantity -= 1;
                    if (foods[name].quantity === 0) {
                        delete foods[name];
                    }
                    updateDailyFoods();
                }
                updateNutritionalInfo();
                updateTotalValues();
            };

            window.increaseQuantity = function(type, name) {
                if (type === 'drink') {
                    drinks[name].quantity += 1;
                    updateDailyDrinks();
                } else if (type === 'food') {
                    foods[name].quantity += 1;
                    updateDailyFoods();
                }
                updateNutritionalInfo();
                updateTotalValues();
            };

            function updateNutritionalInfo() {
                var $nutritionalInfo = $("#nutritionalInfo");
                $nutritionalInfo.empty();

                $.each(drinks, function(name, info) {
                    var totalCalories = info.calorie * info.quantity;
                    var totalCost = info.costo * info.quantity;

                    $nutritionalInfo.append('<tr><td>' + name + '</td><td>Drink</td><td>' + info.calorie + '</td><td>' + (info.carbs || 0) + '</td><td>' + (info.sugars || 0) + '</td><td>' + (info.protein || 0) + '</td><td>' + (info.fat || 0) + '</td><td>' + info.quantity + '</td><td>' + totalCalories + '</td><td>' + info.costo + '€</td><td>' + totalCost + '€</td></tr>');
                });

                $.each(foods, function(name, info) {
                    var totalCalories = info.calorie * info.quantity;
                    var totalCost = info.costo * info.quantity;

                    $nutritionalInfo.append('<tr><td>' + name + '</td><td>Food</td><td>' + info.calorie + '</td><td>' + (info.carbs || 0) + '</td><td>' + (info.sugars || 0) + '</td><td>' + (info.protein || 0) + '</td><td>' + (info.fat || 0) + '</td><td>' + info.quantity + '</td><td>' + totalCalories + '</td><td>' + info.costo + '€</td><td>' + totalCost + '€</td></tr>');
                });
            }

            function updateTotalValues() {
                var totalDrinkCalories = calculateTotalCalories('drink');
                var totalFoodCalories = calculateTotalCalories('food');
                var totalCost = calculateTotalCost();

                $("#totalDrinkCalories").text("Calorie Totali (Drink): " + totalDrinkCalories);
                $("#totalFoodCalories").text("Calorie Totali (Cibo): " + totalFoodCalories);
                $("#totalCalories").text("Calorie Totali: " + (totalDrinkCalories + totalFoodCalories));
                $("#totalCost").text("Costo Totale: " + totalCost + "€");

                $("#weeklyCost").text("Costo Settimanale: " + (totalCost * 7) + "€");
                $("#monthlyCost").text("Costo Mensile: " + (totalCost * 30) + "€");
                $("#yearlyCost").text("Costo Annuale: " + (totalCost * 365) + "€");
            }

            function calculateTotalCalories(type) {
                var totalCalories = 0;

                if (type === 'drink') {
                    $.each(drinks, function(name, info) {
                        totalCalories += info.calorie * info.quantity;
                    });
                } else if (type === 'food') {
                    $.each(foods, function(name, info) {
                        totalCalories += info.calorie * info.quantity;
                    });
                } else {
                    $.each(drinks, function(name, info) {
                        totalCalories += info.calorie * info.quantity;
                    });
                    $.each(foods, function(name, info) {
                        totalCalories += info.calorie * info.quantity;
                    });
                }

                return totalCalories;
            }

            function calculateTotalCost() {
                var totalCost = 0;

                $.each(drinks, function(name, info) {
                    totalCost += info.costo * info.quantity;
                });

                $.each(foods, function(name, info) {
                    totalCost += info.costo * info.quantity;
                });

                return totalCost;
            }

            function calculateTotalNutrients(type) {
                var totalValues = {
                    calories: 0,
                    carbs: 0,
                    sugars: 0,
                    protein: 0,
                    fat: 0
                };

                if (type === 'drink') {
                    $.each(drinks, function(name, info) {
                        totalValues.calories += info.calorie * info.quantity;
                        totalValues.carbs += (info.carbs || 0) * info.quantity;
                        totalValues.sugars += (info.sugars || 0) * info.quantity;
                        totalValues.protein += (info.protein || 0) * info.quantity;
                        totalValues.fat += (info.fat || 0) * info.quantity;
                    });
                } else if (type === 'food') {
                    $.each(foods, function(name, info) {
                        totalValues.calories += info.calorie * info.quantity;
                        totalValues.carbs += (info.carbs || 0) * info.quantity;
                        totalValues.sugars += (info.sugars || 0) * info.quantity;
                        totalValues.protein += (info.protein || 0) * info.quantity;
                        totalValues.fat += (info.fat || 0) * info.quantity;
                    });
                }

                return totalValues;
            }
        });
    </script>
</body>
</html>
